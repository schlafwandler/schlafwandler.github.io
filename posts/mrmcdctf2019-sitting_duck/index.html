<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Pointers to the void  | MRMCDCTF2019: Sitting duck</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.52" />
    
    
      <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
    

    
    
      <link href="https://schlafwandler.github.io/dist/css/app.d98f2eb6bcd1eaedb7edf166bd16af26.css" rel="stylesheet">
    

    

    
      
    

    <meta content="CTF, capture the flag, strings, linux, binary" name="keywords">
    <meta content=" - " property="og:description">

    

    <meta property="og:title" content="MRMCDCTF2019: Sitting duck" />
<meta property="og:description" content="Solution to Sitting duck (very easy) from MRMCDCTF 2019 Sitting duck was by far the easiest challenge I have written for the MRMCD 2019 CTF. It was targeted mostly at total CTF newbies that had absolutely no previous experience with reversing challenges.
The challenge gives you a binary file and the hint that it is solvable with very little experience.
When executing the file, it asks us for the flag." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://schlafwandler.github.io/posts/mrmcdctf2019-sitting_duck/" /><meta property="article:published_time" content="2019-09-16T17:27:35&#43;02:00"/>
<meta property="article:modified_time" content="2019-09-16T17:27:35&#43;02:00"/>


<meta itemprop="name" content="MRMCDCTF2019: Sitting duck">
<meta itemprop="description" content="Solution to Sitting duck (very easy) from MRMCDCTF 2019 Sitting duck was by far the easiest challenge I have written for the MRMCD 2019 CTF. It was targeted mostly at total CTF newbies that had absolutely no previous experience with reversing challenges.
The challenge gives you a binary file and the hint that it is solvable with very little experience.
When executing the file, it asks us for the flag.">


<meta itemprop="datePublished" content="2019-09-16T17:27:35&#43;02:00" />
<meta itemprop="dateModified" content="2019-09-16T17:27:35&#43;02:00" />
<meta itemprop="wordCount" content="667">



<meta itemprop="keywords" content="MRMCDCTF2019,CTF," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MRMCDCTF2019: Sitting duck"/>
<meta name="twitter:description" content="Solution to Sitting duck (very easy) from MRMCDCTF 2019 Sitting duck was by far the easiest challenge I have written for the MRMCD 2019 CTF. It was targeted mostly at total CTF newbies that had absolutely no previous experience with reversing challenges.
The challenge gives you a binary file and the hint that it is solvable with very little experience.
When executing the file, it asks us for the flag."/>

      
    
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-navy">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://schlafwandler.github.io" class="f3 fw2 hover-white no-underline white-90 dib">
      Pointers to the void
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://schlafwandler.github.io/tags/" title=" page">
              
            </a>
          </li>
          
        </ul>
      
      











    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        POSTS
      </p>
      <h1 class="f1 athelas mb1">MRMCDCTF2019: Sitting duck</h1>
      
      <time class="f6 mv4 dib tracked" datetime="2019-09-16T17:27:35&#43;02:00">September 16, 2019</time>      
      
      
    </header>

    <section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l">

<h2 id="solution-to-sitting-duck-very-easy-from-mrmcdctf-2019">Solution to Sitting duck (very easy) from MRMCDCTF 2019</h2>

<p><a href="https://github.com/schlafwandler/CTF-challenges/tree/master/MRMCDCTF-2019/reversing/Sitting_duck">Sitting duck</a>
was by far the easiest challenge I have written for the MRMCD 2019 CTF.
It was targeted mostly at total CTF newbies that had absolutely no previous experience with reversing challenges.</p>

<p>The challenge gives you a <a href="https://github.com/schlafwandler/CTF-challenges/raw/master/MRMCDCTF-2019/reversing/Sitting_duck/sitting_duck">binary file</a>
and the hint that it is solvable with very little experience.</p>

<p>When executing the file, it asks us for the flag.
And if we don&rsquo;t enter the correct flag, it tells us we are wrong.</p>

<pre><code>user@host:$ ./sitting_duck 
The password is the flag. What is the password?
foobar
Wrong. Try again.
user@host:$
</code></pre>

<p>What does this tell us?
Well, now we know that the program has a quick way to check if the flag is correct.
That must mean it has some information about the flag inside it, otherwise it could not tell a correct flag from a incorrect one.
And the challenge here (and in most other reversing challenges) is to dig for this information and use it to infer the correct flag.</p>

<p>A common first step when dealing with a unknown binary file is using the <code>file</code> command on it.
<code>file</code> tries to identify the file type by checking for various magic values in the file.
You can learn more on its manpage (<code>man file</code>).</p>

<pre><code>user@host:$ file sitting_duck 
sitting_duck: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=c45e7154481418735d8207ac7a8133402ce4e013, for GNU/Linux 3.2.0, not stripped
</code></pre>

<p>Here it gives us the information that we are dealing with a 64 bit ELF file, the standard type for Linux executables on X86-64 systems.
Nothing too spectacular.</p>

<p>A usual next step is to use <code>strings</code>. <code>strings</code> searches a file for all printable character sequences and puts them on the screen.
There are some adjustments you can make concerning what exactly to look for (see <code>man strings</code>), but we stick with the defaults here:</p>

<pre><code>user@host:$ strings sitting_duck 
/lib64/ld-linux-x86-64.so.2
^qTH
mgUa
libc.so.6
puts
__stack_chk_fail
stdin
strtok
fgets
__cxa_finalize
strcmp
__libc_start_main
GLIBC_2.4
GLIBC_2.2.5
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
u/UH
[]A\A]A^A_
The password is the flag. What is the password?
##############################################
###   Congratulations! This is the flag!   ###
##############################################
Wrong. Try again.
;*3$&quot;
MRMCDCTF{you_call_this_a_challenge_questionmark}
GCC: (Ubuntu 8.3.0-6ubuntu1) 8.3.0
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.7963
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
sitting_duck.c
__FRAME_END__
__init_array_end
_DYNAMIC
__init_array_start
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_csu_fini
_ITM_deregisterTMCloneTable
puts@@GLIBC_2.2.5
stdin@@GLIBC_2.2.5
_edata
__stack_chk_fail@@GLIBC_2.4
password
__libc_start_main@@GLIBC_2.2.5
fgets@@GLIBC_2.2.5
__data_start
strcmp@@GLIBC_2.2.5
__gmon_start__
__dso_handle
_IO_stdin_used
__libc_csu_init
__bss_start
main
strtok@@GLIBC_2.2.5
__TMC_END__
_ITM_registerTMCloneTable
__cxa_finalize@@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.interp
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.data
.bss
.comment
</code></pre>

<p>What do we see here?</p>

<p>A lot of these strings were not part of the original source code, but put in by the compiler when creating the binary file.
They describe sections of the binary (like &lsquo;.text&rsquo;), functions added by the compiler (like &lsquo;deregister_tm_clones&rsquo;) and functions imported from
shared libraries (like &lsquo;fgets@@GLIBC_2.2.5&rsquo;).
We can even see the exact compiler version that was used to build the program: &lsquo;GCC: (Ubuntu 8.3.0-6ubuntu1) 8.3.0&rsquo;.
Information like this can be found in most Linux executables, but none of it is especially interesting here.</p>

<p>Other strings obviously come from the programmer:
We see the &ldquo;What is the password?&rdquo;-message, the &ldquo;Wrong. Try again.&rdquo;-message and even the &ldquo;Congratulations!- message that will be displayed once
the correct flag is entered.</p>

<p>And there is one even more interesting string in the binary: &lsquo;MRMCDCTF{you_call_this_a_challenge_questionmark}&lsquo;.</p>

<p>Well, here is is:
The flag is contained in the binary in clear text.</p>

<p>A quick check confirms it:</p>

<pre><code>user@host:$ ./sitting_duck 
The password is the flag. What is the password?
MRMCDCTF{you_call_this_a_challenge_questionmark}

##############################################
###   Congratulations! This is the flag!   ###
##############################################
</code></pre>

<p>And so &lsquo;MRMCDCTF{you_call_this_a_challenge_questionmark}&rsquo; really is the solution.
Not so hard, was it?</p>

<p>Fun fact:
There was an other challenge (&lsquo;Hacker Protocols&rsquo;) that was designed as a sort of sanity check
(a challenge that gives you really few point basically for free).
That challenge was to log onto IRC and join the CTFs official channel.
The flag was displayed openly in the channel topic.
That challenge was solved fewer times than sitting duck.</p>
<ul class="pa0">
  
   <li class="list">
     <a href="https://schlafwandler.github.io/tags/mrmcdctf2019" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">MRMCDCTF2019</a>
   </li>
  
   <li class="list">
     <a href="https://schlafwandler.github.io/tags/ctf" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">CTF</a>
   </li>
  
</ul>
<div class="mt6">
        
      </div>
    </section>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-navy bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://schlafwandler.github.io" >
    &copy; 2019 Pointers to the void
  </a>
    <div>










</div>
  </div>
</footer>

    

  <script src="https://schlafwandler.github.io/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
